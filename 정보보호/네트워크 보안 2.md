# 네트워크 보안

<br/>

**스니핑 공격**

일종의 도청이다.  

유선 랜을 통한 스니핑 공격을 살펴보자.  

<br/>

**1. 원리**

공격 대상이 속한 LAN 안에 호스트들과 포트로 연결되어있는 스위치가 있다.

이 스위치의 임의의 한 포트에 해커가 스니퍼(스니핑을 하는 호스트)를 연결한 것이다.

이 포트를 통해서 랜덤 형태로 생성한 MAC 주소를 가진 패킷을 스위치에 무한대로 보내면

포트와 MAC 주소가 매핑되어 기록되어있는 이더넷용 표의 저장용량을 초과하게 되어 스위칭 기능을 상실시킨다. 

즉, 더미 허브로 만든다. 이를 **스위치 재밍 공격**이라고 한다.

<br/>


더미 허브는 한 포트로 들어온 패킷을 다른 포트에 연결되어있는 모든 호스트에게 보내는 브로드캐스트 방식을 차용하므로

한 호스트가 스위치로 패킷을 보내게 되면, 이는 다른 포트에 연결되어있던 라우터, 다른 호스트들 그리고 **스니퍼로 까지 브로드캐스트!**

스니퍼는 LAN 카드의 모드를 프러미스큐어스 모드로 바꿈으로써 수신처 MAC주소와 IP주소가 

본인과 다른 MAC 주소와 IP 주소인 패킷이면 폐기하는 이더넷의 기본 원리인 **필터링 기능을 해제**한다. 

이렇게 해당 LAN 내에서 오가는 모든 패킷을 엿볼 수 있는 것이다.

![화면 캡처 2022-09-24 150650](https://user-images.githubusercontent.com/93998875/192087583-59806147-f685-4ae5-ae6a-27a3c8ad47b2.png)


<br/>

**2. 탐지**

스니퍼가 프러미스큐어스 모드에서 작동한다는 점을 이용해야 한다.

1. ping

의심이 가는 호스트에 ping을 보내는데, 존재하지 않는 MAC 주소를 가진 ping 을 보낸다.

만약 이에 대한 ICMP Reply가 온다면 이를 회신한 호스트가 바로 스니퍼인 것이다. 정상 호스트라면 이 ping을 폐기하기 때문이다.

![화면 캡처 2022-09-24 150703](https://user-images.githubusercontent.com/93998875/192094162-4da9f340-a00d-451b-90a2-2a2bdf2fdbb2.png)


<br/>

2. ARP

위와 유사하게 위조된ARP 리퀘스트를 보냈을 때 응답이 온다면 이 호스트는 프러미스큐어스 모드구나, 스니퍼구나 탐지

<br/>

3. DNS

테스트 대상 네트워크로 ping sweep을 보내고 들어오는 Reverse-DNS lookup을 감시하여 스니퍼를 탐지

<br/>

4. 유인

스니핑의 주요목적은 **아이디와 패스워드** 획득이다.

보안 관리자는 가짜 아이디와 패스워드를 네트워크에 계속 뿌리고, 공격자가 이것으로 접속을 시도핼 때 스니퍼를 탐지

<br/>

5. ARP watch

MAC 주소와 IP 주소의 매칭값을 초기에 저장하고 ARP 트래픽을 모니터링하여 이를 변하게 하는 패킷이 탐지되면

관리자에게 메일로 알려주는 툴이다. 대부분의 공격은 위조된 ARP를 사용하기에 쉽게 탐지

<br/><br/><br/>

**스푸핑 공격**

일종의 속이는 것이다.

1. ARP 스푸핑 공격

* LAN에 있는 공격자가 같은 LAN에서 통신하고 있는 클라이언트와 서버에게 서로의 MAC 주소를 
* 
  공격자 자신의 MAC 주소라고 속여서 알린다.   
  서버와 클라이언트가 상대방의 MAC 주소라고 알고 있는 것이 사실은 공격자의 MAC 주소인 것이다.  
  
  그래서 둘 사이의 패킷은 모두 공격자로 오고, 공격자는 이를 다 수신한 뒤 둘에게 다시 보내줌으로써 통신에 오류가 없게끔 한다.
  
  ![화면 캡처 2022-09-24 150738](https://user-images.githubusercontent.com/93998875/192094321-5edc972a-e231-4766-8b3b-d220717d7332.png)
  
* 서버나 클라이언트측의 호스트에 있는 ARP 테이블에 arp -s [IP][MAC] 명령을 하면 되지만 일일이 번거롭고 근본적 해결책이 없다.

